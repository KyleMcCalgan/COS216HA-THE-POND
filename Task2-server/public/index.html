<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Couriers API Test Client</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Couriers API Test Client</h1>
    
    <div class="api-info">
        <p id="api-url-display">Connecting to API...</p>
    </div>

    <div class="nav-buttons">
        <button class="nav-button active" data-section="connection">Connection Test</button>
        <button class="nav-button" data-section="users">Users</button>
        <button class="nav-button" data-section="orders">Orders</button>
        <button class="nav-button" data-section="drones">Drones</button>
        <button class="nav-button" data-section="debug">Debug</button>
    </div>

    <div class="container">
        <div class="panel">
            <!-- Connection Test Section -->
            <div class="section-content active" id="connection">
                <div class="api-section">
                    <h3>Test Database Connection</h3>
                    <button id="testConnectionBtn">Test Connection</button>
                </div>
            </div>

            <!-- Users Section -->
            <div class="section-content" id="users">
                <div class="api-section">
                    <h3>Login</h3>
                    <div class="input-group">
                        <label for="loginUsername">Username:</label>
                        <input type="text" id="loginUsername" value="admin">
                    </div>
                    <div class="input-group">
                        <label for="loginPassword">Password:</label>
                        <input type="password" id="loginPassword" value="admin">
                    </div>
                    <button id="loginBtn">Login</button>
                </div>

                <div class="api-section">
                    <h3>Create User</h3>
                    <div class="input-group">
                        <label for="createUsername">Username:</label>
                        <input type="text" id="createUsername" value="testuser">
                    </div>
                    <div class="input-group">
                        <label for="createPassword">Password:</label>
                        <input type="password" id="createPassword" value="password123">
                    </div>
                    <div class="input-group">
                        <label for="createEmail">Email:</label>
                        <input type="email" id="createEmail" value="test@example.com">
                    </div>
                    <div class="input-group">
                        <label for="createUserType">User Type:</label>
                        <select id="createUserType">
                            <option value="Customer">Customer</option>
                            <option value="Courier">Courier</option>
                            <option value="Distributor">Distributor</option>
                        </select>
                    </div>
                    <button id="createUserBtn">Create User</button>
                </div>

                <div class="api-section">
                    <h3>Get All Couriers</h3>
                    <button id="getAllCouriersBtn">Get All Couriers</button>
                </div>
            </div>

            <!-- Orders Section -->
            <div class="section-content" id="orders">
                <div class="api-section">
                    <h3>Create Order</h3>
                    <div class="input-group">
                        <label for="orderCustomerId">Customer ID:</label>
                        <input type="number" id="orderCustomerId" value="1">
                    </div>
                    <div class="input-group">
                        <label for="orderDestLat">Destination Latitude:</label>
                        <input type="text" id="orderDestLat" value="25.7500">
                    </div>
                    <div class="input-group">
                        <label for="orderDestLong">Destination Longitude:</label>
                        <input type="text" id="orderDestLong" value="28.2480">
                    </div>
                    <div class="input-group">
                        <label for="orderProducts">Products (JSON format):</label>
                        <input type="text" id="orderProducts" value='[{"id": 1, "quantity": 2}, {"id": 2, "quantity": 1}]'>
                    </div>
                    <button id="createOrderBtn">Create Order</button>
                </div>

                <div class="api-section">
                    <h3>Get All Orders</h3>
                    <div class="input-group">
                        <label for="getAllOrdersUserId">User ID:</label>
                        <input type="number" id="getAllOrdersUserId" value="1">
                    </div>
                    <div class="input-group">
                        <label for="getAllOrdersUserType">User Type:</label>
                        <select id="getAllOrdersUserType">
                            <option value="Courier">Courier</option>
                            <option value="Customer">Customer</option>
                        </select>
                    </div>
                    <button id="getAllOrdersBtn">Get All Orders</button>
                </div>

                <div class="api-section">
                    <h3>Get Specific Order</h3>
                    <div class="input-group">
                        <label for="getOrderCustomerId">Customer ID:</label>
                        <input type="number" id="getOrderCustomerId" value="1">
                    </div>
                    <div class="input-group">
                        <label for="getOrderId">Order ID:</label>
                        <input type="number" id="getOrderId" value="1">
                    </div>
                    <button id="getOrderBtn">Get Order</button>
                </div>

                <div class="api-section">
                    <h3>Update Order</h3>
                    <div class="input-group">
                        <label for="updateOrderCustomerId">Customer ID:</label>
                        <input type="number" id="updateOrderCustomerId" value="1">
                    </div>
                    <div class="input-group">
                        <label for="updateOrderId">Order ID:</label>
                        <input type="number" id="updateOrderId" value="1">
                    </div>
                    <div class="input-group">
                        <label for="updateOrderDestLat">Destination Latitude (optional):</label>
                        <input type="text" id="updateOrderDestLat" value="25.7490">
                    </div>
                    <div class="input-group">
                        <label for="updateOrderDestLong">Destination Longitude (optional):</label>
                        <input type="text" id="updateOrderDestLong" value="28.2500">
                    </div>
                    <div class="input-group">
                        <label for="updateOrderState">State (optional):</label>
                        <select id="updateOrderState">
                            <option value="Storage">Storage</option>
                            <option value="Out_for_delivery">Out for Delivery</option>
                            <option value="Delivered">Delivered</option>
                        </select>
                    </div>
                    <button id="updateOrderBtn">Update Order</button>
                </div>
            </div>

            <!-- Drones Section -->
            <div class="section-content" id="drones">
                <div class="api-section">
                    <h3>Create Drone</h3>
                    <div class="input-group">
                        <label for="droneIsAvailable">Is Available:</label>
                        <select id="droneIsAvailable">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="droneLatitude">Latitude:</label>
                        <input type="text" id="droneLatitude" value="25.7472">
                    </div>
                    <div class="input-group">
                        <label for="droneLongitude">Longitude:</label>
                        <input type="text" id="droneLongitude" value="28.2511">
                    </div>
                    <div class="input-group">
                        <label for="droneAltitude">Altitude:</label>
                        <input type="number" id="droneAltitude" value="0">
                    </div>
                    <div class="input-group">
                        <label for="droneBatteryLevel">Battery Level (0-100):</label>
                        <input type="number" id="droneBatteryLevel" value="100" min="0" max="100">
                    </div>
                    <div class="input-group">
                        <label for="droneOperatorId">Operator ID (optional):</label>
                        <input type="number" id="droneOperatorId" placeholder="Leave empty for no operator">
                    </div>
                    <button id="createDroneBtn">Create Drone</button>
                </div>

                <div class="api-section">
                    <h3>Get All Drones</h3>
                    <button id="getAllDronesBtn">Get All Drones</button>
                </div>

                <div class="api-section">
                    <h3>Update Drone</h3>
                    <div class="input-group">
                        <label for="updateDroneId">Drone ID:</label>
                        <input type="number" id="updateDroneId" value="1">
                    </div>
                    <div class="input-group">
                        <label for="updateDroneIsAvailable">Is Available (optional):</label>
                        <select id="updateDroneIsAvailable">
                            <option value="">-- No Change --</option>
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="updateDroneLatitude">Latitude (optional):</label>
                        <input type="text" id="updateDroneLatitude" placeholder="Leave empty to not update">
                    </div>
                    <div class="input-group">
                        <label for="updateDroneLongitude">Longitude (optional):</label>
                        <input type="text" id="updateDroneLongitude" placeholder="Leave empty to not update">
                    </div>
                    <div class="input-group">
                        <label for="updateDroneAltitude">Altitude (optional):</label>
                        <input type="number" id="updateDroneAltitude" placeholder="Leave empty to not update">
                    </div>
                    <div class="input-group">
                        <label for="updateDroneBatteryLevel">Battery Level (optional, 0-100):</label>
                        <input type="number" id="updateDroneBatteryLevel" placeholder="Leave empty to not update" min="0" max="100">
                    </div>
                    <div class="input-group">
                        <label for="updateDroneOperatorId">Operator ID (optional):</label>
                        <input type="text" id="updateDroneOperatorId" placeholder="Leave empty to not update, use 'null' to remove">
                    </div>
                    <button id="updateDroneBtn">Update Drone</button>
                </div>
            </div>

            <!-- Debug Section -->
            <div class="section-content" id="debug">
                <div class="api-section">
                    <h3>WebSocket Status</h3>
                    <div id="websocket-status">Not connected</div>
                    <button id="connectWebSocketBtn">Connect WebSocket</button>
                </div>

                <div class="api-section">
                    <h3>Server Information</h3>
                    <button id="getServerInfoBtn">Get Server Info</button>
                </div>

                <div class="api-section">
                    <h3>Active Users</h3>
                    <div id="active-users-container">
                        <div class="debug-table-wrapper">
                            <table id="active-users-table">
                                <thead>
                                    <tr>
                                        <th>Username</th>
                                        <th>User Type</th>
                                        <th>User ID</th>
                                        <th>Connected At</th>
                                        <th>Last Active</th>
                                    </tr>
                                </thead>
                                <tbody id="active-users">
                                    <tr>
                                        <td colspan="5">No active users</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="api-section">
                    <h3>Orders Being Delivered</h3>
                    <div id="orders-container">
                        <div class="debug-table-wrapper">
                            <table id="orders-table">
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Customer ID</th>
                                        <th>Tracking Number</th>
                                        <th>Start Time</th>
                                        <th>Destination</th>
                                    </tr>
                                </thead>
                                <tbody id="delivering-orders">
                                    <tr>
                                        <td colspan="5">No orders being delivered</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="api-section">
                    <h3>Recent Database Changes</h3>
                    <div id="db-changes-container">
                        <div class="debug-table-wrapper">
                            <table id="db-changes-table">
                                <thead>
                                    <tr>
                                        <th>Timestamp</th>
                                        <th>Operation</th>
                                        <th>Success</th>
                                        <th>Details</th>
                                    </tr>
                                </thead>
                                <tbody id="db-changes">
                                    <tr>
                                        <td colspan="4">No database changes recorded</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="api-section">
                    <h3>Server Log</h3>
                    <div id="server-log-container">
                        <pre id="server-log">No server log entries yet.</pre>
                    </div>
                    <button id="clearLogBtn">Clear Log</button>
                </div>
            </div>
        </div>

        <div class="panel">
            <h3>API Response</h3>
            <pre id="response">No response yet. Click any API button to test.</pre>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>